jQuery(document).ready(function(t){function o(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}t("#molongui-options").on("click","#activate_license_button",function(){event.preventDefault();var e=t(this),i=t("#key"),n=t("#product_id"),s=i.val().trim(),a=n.val().trim();if(!s||!a)return molongui_swal({icon:"error",title:mfw_options[201],text:mfw_options[202]}),!1;if(Math.floor(a)!=a||!t.isNumeric(a))return molongui_swal({icon:"error",title:mfw_options[216],text:mfw_options[217]}),!1;var l=t(this).html();t(this).html('<div class="m-typing-loader"></div>'),t.ajax({url:ajaxurl,type:"POST",data:{action:mfw_options.plugin_id+"_activate_license_key",nonce:mfw_options[200],key:s,pid:a},success:function(s){let a=t.parseJSON(s);console.log("%cMOLONGUI LICENSING SERVER RESPONSE\n%c"+o(a[0])+"\n%c"+o(a[1]),"font-weight: bold; text-decoration: underline;","text-transform: capitalize; color: red;",""),"success"===a[0]?molongui_swal({icon:"success",title:mfw_options[203],text:a[1]}).then(o=>{i.closest(".m-option").removeClass("m-license-off").addClass("m-license-on"),n.closest(".m-option").removeClass("m-license-off").addClass("m-license-on"),e.attr("id","deactivate_license_button").removeClass("is-primary").addClass("m-deactivate").html(mfw_options[215]),e.off("click"),t("#molongui-options").attr("style","opacity: 0.35"),t("#m-options-saving").fadeIn(),t(window).off("beforeunload"),location.reload(!0),window.location.assign(mfw_options.options_page)}):molongui_swal({icon:"error",title:mfw_options[204],content:{element:"span",attributes:{innerHTML:o(a[1])}}}).then(t=>{e.html(l),i.closest(".m-option").addClass("m-license-off"),n.closest(".m-option").addClass("m-license-off")}),t(this).html(t(this).prop("title"))},error:function(t,o,i){console.error(JSON.stringify(t)),console.error("AJAX Error: textStatus  = "+o),console.error("AJAX Error: errorThrown = "+i),molongui_swal(mfw_options[205],mfw_options[206],"error").then(t=>{e.html(l)})}})}),t("#molongui-options").on("click","#deactivate_license_button",function(){event.preventDefault();var o=t(this),e=t("#activation_key"),i=t("#activation_email"),n=t(this).html();t(this).html('<div class="m-typing-loader blue"></div>'),molongui_swal({icon:"info",title:mfw_options[207],text:mfw_options[208],closeOnEsc:!0,buttons:{cancel:{text:mfw_options[209],value:null,visible:!0,className:"",closeModal:!0},confirm:{text:mfw_options[210],value:!0,visible:!0,className:"",closeModal:!1}}}).then(s=>{s&&t.ajax({url:ajaxurl,type:"POST",data:{action:mfw_options.plugin_id+"_deactivate_license_key",nonce:mfw_options[200],form:t("form#molongui-settings-form").serializeArray()},success:function(s){console.log("MOLONGUI LICENSING SERVER RESPONSE: "+s.replace(/<\/?[^>]+>/gi,""));var a=t.parseJSON(s);"success"===a[0]?molongui_swal({icon:"success",title:mfw_options[211],text:a[1]}).then(n=>{e.val("").closest(".m-option").removeClass("m-license-on"),i.val("").closest(".m-option").removeClass("m-license-on"),o.attr("id","activate_license_button").removeClass("m-deactivate").addClass("is-primary").html(mfw_options[214]),o.off("click"),t("#molongui-options").attr("style","opacity: 0.35"),t("#m-options-saving").fadeIn(),t(window).off("beforeunload"),location.reload(!0),window.location.assign(mfw_options.options_page)}):molongui_swal({icon:"error",title:mfw_options[212],text:a[1]}).then(t=>{o.html(n)})},error:function(t,e,i){console.error(JSON.stringify(t)),console.error("AJAX Error: textStatus  = "+e),console.error("AJAX Error: errorThrown = "+i),molongui_swal(mfw_options[205],mfw_options[213],"error").then(t=>{o.html(n)})}})}),o.html(n)})}),function(t){"use strict";t(".m-section-nav__mobile-header").on("click",function(){t(this).parent().toggleClass("is-open")}),t(".m-section-nav__panel").on("click",function(){t(this).parent().removeClass("is-open")}),t(".m-section-nav-tab__link").on("click",function(o){o.preventDefault();var e=t(this).attr("href");t(".m-section-nav-tab").removeClass("is-selected"),t(this).parent().addClass("is-selected"),t(".m-section-nav__mobile-header").html(t(this).find(".m-section-nav-tab__text").text()),t(".m-tab").removeClass("current"),t(e).addClass("current")}),t(".ui.dropdown").dropdown().dropdown({selector:{input:'> input[type="hidden"], > input[type="text"], > select'},message:{noResults:"<strong>No more options available.</strong>"}}),t(".m-support-info").popup({inline:!0,hoverable:!0,position:"left center",delay:{show:300,hide:600}}),t(".m-option input").on("change input",function(){t(this).closest(".m-card").prevAll(".m-card-header:first").find(".m-card-header__actions .m-button").prop("disabled",!1).addClass("is-primary")});var o=function(o=!1){o||(t("#molongui-options").attr("style","opacity: 0.35"),t("#m-options-saving").fadeIn());var e=function(){var o={};return t(".m-section-nav-tab__link").each(function(){var e=t(this).data("id"),i={};t("#molongui-options [name^="+e+"]").each(function(){if(t(this).is("input[type=text]")||t(this).is("input[type=number]")||t(this).is("textarea")||t(this).is("input[type=hidden]")||t(this).is("select")){var o=t(this).val();t.isArray(o)&&(o=o.toString()),i[t(this).attr("id")]=o}else t(this).is("input[type=checkbox]:checked")?i[t(this).attr("id")]=1:t(this).is("input[type=checkbox]")?i[t(this).attr("id")]=null:t(this).is("input[type=radio]:checked")&&(i[t(this).attr("data-id")]=t(this).val())}),o[e]=i}),o}();jQuery.post(ajaxurl,{action:mfw_options.plugin_id+"_save_options",data:e,nonce:t("#mfw_save_options_nonce").val()},function(e){t("input, textarea").each(function(){t(this).attr("disabled","disabled")}),o||("false"!==e?(t("#m-options-saving").fadeOut(),t("#m-options-saved").fadeIn()):(t("#m-options-saving").fadeOut(),t("#m-options-error").fadeIn()),setTimeout(function(){t(window).off("beforeunload"),"false"!==e?(t("#m-options-saved").fadeOut(),t(".m-card-header__actions .m-button-save").blur().prop("disabled",!0).removeClass("is-primary")):t("#m-options-error").fadeOut(),t("input, textarea").each(function(){t(this).removeAttr("disabled")}),t("#molongui-options").removeAttr("style"),t(document).trigger("m_settings_saved")},1500))})};t(".m-button-save").click(function(t){t.preventDefault(),o(!1)}),t(document).keydown(function(t){return"s"!==t.key&&"S"!==t.key||!t.ctrlKey&&!t.metaKey||(t.preventDefault(),o(!1),!1)}),t("#export_options").on("click",function(o){o.preventDefault();var e=t(this),i=t(this).html();t(this).html('<div class="m-typing-loader blue"></div>'),jQuery.post(ajaxurl,{action:mfw_options.plugin_id+"_export_options",plugin:mfw_options.plugin_id},function(t){var o=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(o);let s=(new Date).toISOString().slice(0,10),a=document.createElement("a");a.download="molongui-"+mfw_options.plugin_id+"-settings."+s+".json",a.href=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),e.html(i)})}),t("#import_options").on("change",function(o){var e=o.target.files[0];if(void 0===e&&!e)return molongui_swal({icon:"error",title:mfw_options[112],text:mfw_options[113]}),!1;t(this);var i=t(this).next("label"),n=i.html();if(i.html('<div class="m-typing-loader blue"></div>'),"text/json"!==e.type&&"application/json"!==e.type)return molongui_swal({icon:"error",title:mfw_options[114],text:mfw_options[115]}).then(t=>{i.html(n)}),!1;var s,a,l,r;molongui_swal({icon:"info",title:mfw_options[116],text:mfw_options[117],closeOnEsc:!0,buttons:{cancel:{text:mfw_options[118],value:null,visible:!0,className:"",closeModal:!0},confirm:{text:mfw_options[119],value:!0,visible:!0,className:"",closeModal:!1}}}).then(o=>{o?(s=e,a=function(o){t.ajax({url:ajaxurl,type:"POST",data:{action:mfw_options.plugin_id+"_import_options",nonce:mfw_options[111],file:o,id:mfw_options.plugin_id,version:mfw_options.plugin_version},success:function(o){if(o){var e="";switch(o){case"file":e=mfw_options[123];break;case"plugin":e=mfw_options[124];break;case"update":e=mfw_options[125]}molongui_swal({icon:"error",title:mfw_options[122],text:e}).then(t=>{i.html(n)})}else molongui_swal({icon:"success",title:mfw_options[120],text:mfw_options[121]}).then(o=>{t(window).off("beforeunload"),location.reload()})},error:function(t,o,e){molongui_swal({icon:"error",title:mfw_options[122],text:mfw_options[130]}).then(t=>{i.html(n)})}})},l="",(r=new FileReader).onload=function(t){l=r.result,a(l)},r.readAsText(s)):i.html(n)}),o.preventDefault()}),t("#reset_options").on("click",function(o){if("0"===mfw_options.is_pro)return molongui_swal({icon:"error",title:mfw_options[1],text:mfw_options[2]}),!1;{var e=t(this),i=t(this).html();let o='<div class="m-typing-loader blue"></div>';t(this).html(o),molongui_swal({icon:"info",title:mfw_options[116],text:mfw_options[126],closeOnEsc:!0,buttons:{cancel:{text:mfw_options[118],value:null,visible:!0,className:"",closeModal:!0},confirm:{text:mfw_options[119],value:!0,visible:!0,className:"",closeModal:!1}}}).then(o=>{o?t.ajax({url:ajaxurl,type:"POST",data:{action:mfw_options.plugin_id+"_reset_options",nonce:mfw_options[127],id:mfw_options.plugin_id},success:function(o){o?molongui_swal({icon:"success",title:mfw_options[120],text:mfw_options[128]}).then(o=>{t(window).off("beforeunload"),location.reload()}):molongui_swal({icon:"error",title:mfw_options[122],text:mfw_options[129]}).then(t=>{e.html(i)})},error:function(t,o,n){molongui_swal({icon:"error",title:mfw_options[122],text:mfw_options[130]}).then(t=>{e.html(i)})}}):e.html(i)})}o.preventDefault()}),t("input, textarea, select").on("change",function(){t(window).on("beforeunload",function(t){return mfw_options[103]})})}(jQuery);